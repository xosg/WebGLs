<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>star</title>
    <style>
        html,
        body {
            margin: 0;
            height: 100%;
            overflow: hidden;
        }

        canvas {
            display: block;
        }
    </style>
</head>

<body>
    <canvas></canvas>

    <script>
        const canvas = document.querySelector("canvas");
        const gl = canvas.getContext("webgl2");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        gl.viewport(0, 0, innerWidth, innerHeight);


        function createShader(gl, type, source) {
            const shader = gl.createShader(type);
            gl.shaderSource(shader, source);
            gl.compileShader(shader);
            return shader;
        }

        const vertex =
            `#version 300 es
             in vec4 a_position;
             void main() {
                gl_Position = a_position;
             }
        `

        const min = (Math.min(innerWidth, innerHeight) / 2).toFixed(1)

        const ratio = innerWidth / innerHeight
        const [x, y] = ratio > 1 ? [ratio, 1] : [1, 1 / ratio]

        const fragment =
            `#version 300 es
            precision highp float;
            out vec4 fragColor;
            uniform float iTime;

            void main() {
                vec2 uv = gl_FragCoord.xy / ${min} - vec2(${x}, ${y});
                vec3 col = 0.5 * cos(iTime + uv.xyx + vec3(0,2,4));
                col -= sqrt(abs(uv.x*uv.x - uv.y*uv.y));
                col -= sqrt(2.0 * abs(uv.x * uv.y));
                fragColor = vec4(col + 1.1, 1.0);
            }
        `

        const vertexShader = createShader(gl, gl.VERTEX_SHADER, vertex);
        const fragmentShader = createShader(gl, gl.FRAGMENT_SHADER, fragment);

        function createProgram(gl, vs, fs) {
            const program = gl.createProgram();
            gl.attachShader(program, vs);
            gl.attachShader(program, fs);
            gl.linkProgram(program);
            return program;
        }

        const program = createProgram(gl, vertexShader, fragmentShader);
        gl.useProgram(program);

        // Fullscreen quad
        const posBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, posBuffer);
        const vertices = new Float32Array([
            -1, -1,
            1, -1,
            -1, 1,
            1, 1,
        ]);
        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);

        const posLoc = gl.getAttribLocation(program, "a_position");
        gl.enableVertexAttribArray(posLoc);
        gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);

        const iTimeLoc = gl.getUniformLocation(program, "iTime");

        function render(time) {
            gl.uniform1f(iTimeLoc, time / 1000);

            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
            requestAnimationFrame(render);
        }

        render();
    </script>
</body>

</html>